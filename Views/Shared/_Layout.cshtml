<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Online</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/Online.styles.css" asp-append-version="true" />
    <style>
        /* Dark Theme Styles */
        body {
            background-color: #1a1a1a;
            color: #e0e0e0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        /* Dark Navbar */
        .navbar {
            background-color: #2d2d2d !important;
            border-bottom: 1px solid #404040;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .navbar-brand {
            color: #ffffff !important;
            font-weight: 600;
            font-size: 1.5rem;
            transition: color 0.3s ease, transform 0.2s ease;
        }

            .navbar-brand:hover {
                color: #64b5f6 !important;
                transform: scale(1.05);
            }

        .nav-link {
            color: #b0b0b0 !important;
            transition: color 0.3s ease;
        }

            .nav-link:hover {
                color: #64b5f6 !important;
            }

        .navbar-toggler {
            border-color: #404040;
        }

        .navbar-toggler-icon {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 0.8%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='m4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
        }

        /* Container */
        .container {
            background-color: #1a1a1a;
        }

        /* Dark Modal */
        .modal-content {
            background-color: #2d2d2d;
            border: 1px solid #404040;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .modal-header {
            border-bottom: 1px solid #404040;
            background-color: #333333;
            border-radius: 12px 12px 0 0;
        }

        .modal-title {
            color: #ffffff;
            font-weight: 600;
        }

        .btn-close {
            filter: invert(1);
            opacity: 0.8;
        }

            .btn-close:hover {
                opacity: 1;
            }

        .modal-body {
            background-color: #2d2d2d;
            border-radius: 0 0 12px 12px;
        }

        /* Easter Egg GIF Styling */
        #easterEggGif {
            display: block;
            max-width: 100%;
            height: auto;
            margin: 0 auto;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease;
        }

            #easterEggGif:hover {
                transform: scale(1.05);
            }

        .easter-egg-modal-body {
            text-align: center;
            padding: 2rem;
        }

        /* Custom scrollbar for dark theme */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #1a1a1a;
        }

        ::-webkit-scrollbar-thumb {
            background: #404040;
            border-radius: 4px;
        }

            ::-webkit-scrollbar-thumb:hover {
                background: #505050;
            }

        /* Selection color */
        ::selection {
            background-color: #64b5f6;
            color: #1a1a1a;
        }

        /* Main content area */
        main {
            min-height: calc(100vh - 200px);
        }

        /* Responsive adjustments */
        @@media (max-width: 768px) {
            .navbar-brand {
                font-size: 1.3rem;
            }

            .easter-egg-modal-body {
                padding: 1rem;
            }
        }

        /* Animation for modal appearance */
        .modal.fade .modal-dialog {
            transform: translate(0, -50px);
            transition: transform 0.3s ease-out;
        }

        .modal.show .modal-dialog {
            transform: translate(0, 0);
        }

        /* Subtle glow effect for interactive elements */
        .navbar-brand:focus,
        .nav-link:focus {
            outline: 2px solid #64b5f6;
            outline-offset: 2px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <header>
        <nav class="navbar navbar-expand-sm navbar-toggleable-sm border-bottom box-shadow mb-3">
            <div class="container-fluid">
                <a class="navbar-brand" asp-area="" asp-controller="Home" asp-action="Index" id="navbarBrandTitle">Online</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target=".navbar-collapse" aria-controls="navbarSupportedContent"
                        aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="navbar-collapse collapse d-sm-inline-flex justify-content-between">
                    <ul class="navbar-nav flex-grow-1">
                        <li class="nav-item">
                            <a class="nav-link" asp-area="" asp-controller="Home" asp-action="Index">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" asp-area="" asp-controller="Home" asp-action="OpcUa">Opc-Ua</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" asp-area="" asp-controller="Home" asp-action="Storico">Storico</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" asp-area="" asp-controller="Home" asp-action="Ricette">Ricette</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <div class="container">
        <main role="main" class="pb-3">
            @RenderBody()
        </main>
    </div>

    <!-- Modal per l'Easter Egg -->
    <div class="modal fade" id="easterEggModal" tabindex="-1" aria-labelledby="easterEggModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="easterEggModalLabel">🐵 Stai Sereno</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body easter-egg-modal-body">
                    <img id="easterEggGif" src="~/images/monkey.gif" alt="Easter Egg GIF" />
                </div>
            </div>
        </div>
    </div>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const navbarBrand = document.getElementById('navbarBrandTitle');
            const easterEggModalElement = document.getElementById('easterEggModal');
            let easterEggModal = null;

            if (easterEggModalElement) {
                easterEggModal = new bootstrap.Modal(easterEggModalElement);
            }

            let clickCount = 0;
            let clickTimer = null;
            const requiredClicks = 5;
            const clickTimeoutDuration = 1500;

            if (navbarBrand && easterEggModal) {
                navbarBrand.addEventListener('click', function (event) {
                    event.preventDefault();

                    clickCount++;

                    // Visual feedback per i click
                    navbarBrand.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        navbarBrand.style.transform = 'scale(1.05)';
                        setTimeout(() => {
                            navbarBrand.style.transform = 'scale(1)';
                        }, 100);
                    }, 100);

                    clearTimeout(clickTimer);
                    clickTimer = setTimeout(function() {
                        clickCount = 0;
                    }, clickTimeoutDuration);

                    if (clickCount === requiredClicks) {
                        // Piccola animazione prima di mostrare il modal
                        navbarBrand.style.color = '#64b5f6';
                        setTimeout(() => {
                            navbarBrand.style.color = '';
                            easterEggModal.show();
                        }, 200);

                        clickCount = 0;
                        clearTimeout(clickTimer);
                    }
                });

                // Aggiungi feedback visivo per indicare che è cliccabile
                navbarBrand.style.cursor = 'pointer';
            } else {
                if (!navbarBrand) console.error("Elemento 'navbarBrandTitle' non trovato.");
                if (!easterEggModal) console.error("Modal 'easterEggModal' non trovato o Bootstrap non inizializzato correttamente.");
            }
        });
    </script>

    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
